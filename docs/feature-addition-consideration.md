# 機能追加検討ドキュメント

## ドキュメント概要

このドキュメントでは、divichart-next-js-appの既存機能を整理し、今後追加すると便利な機能について検討します。

## 作成日

2026年2月9日

---

## 現在の機能一覧

### 1. 基本機能

#### 1.1 配当金データの可視化

- CSVファイルから配当金データを読み込み
- Shift-JISエンコーディングに対応
- 年別の配当金を集計して表示

#### 1.2 複数のビュー

- **年別配当グラフ** (`/`): 棒グラフで年別配当金を表示
- **累計配当グラフ** (`/cumulative`): 折れ線グラフで累計配当金を表示
- **ポートフォリオ分析** (`/portfolio`): 年別の銘柄別配当構成を円グラフと表で表示

#### 1.3 為替レート機能

- USドル建て配当金の円換算
- 為替レート（1ドル=円）を動的に変更可能
- デフォルト値: 150円（環境変数で設定可能）

#### 1.4 UI/UX機能

- ダークモード対応
- レスポンシブデザイン（モバイル/タブレット/デスクトップ）
- インタラクティブなチャート（ツールチップ表示）

---

## 提案する新機能

以下の機能は、既存機能を補完し、ユーザーの利便性を向上させるものです。

### カテゴリ0: 高優先度機能（★★★）

#### 機能0-1: CSVファイルのアップロード機能 ★★★

**概要**
ブラウザ上から直接CSVファイルをアップロードし、配当金データを表示できる機能

**メリット**

- 現在は `public/data/` フォルダへの手動配置が必要だが、UIから直接ファイルを選択できるようになる
- 技術的な知識がなくても最新データを反映できる
- 複数のCSVファイルを簡単に切り替えられる

**実装の考慮点**

- `<input type="file">` または ドラッグ&ドロップによるファイル選択UI
- Shift-JISエンコーディングの維持（TextDecoderを引き続き使用）
- アップロードしたファイルのバリデーション（必須カラムの存在確認）
- IndexedDB または LocalStorage によるデータ保持（SessionStorageはタブを閉じるとデータが消えるため不適切）

**想定工数**: 6-8時間

**優先度**: 高

---

#### 機能0-2: 月別配当金カレンダービュー ★★★

**概要**
月次の配当金受取スケジュールをカレンダー形式で表示する新しいビュー

**メリット**

- どの月にどれだけの配当金が入るか一目でわかる
- 配当金の受取タイミングのムラを把握できる
- 月次目標達成率をカレンダー上で確認できる

**実装の考慮点**

- `/calendar` などの新しいページとして追加
- 月ごとの配当金サマリーと日付別の配当入金日を表示
- 配当金額に応じたヒートマップ表示
- 既存の月次目標設定との連携

**想定工数**: 8-10時間

**優先度**: 高

---

#### 機能0-3: 銘柄別トレンド分析 ★★★

**概要**
個別銘柄の配当金推移をトレンドグラフで表示する分析機能

**メリット**

- 銘柄ごとの増配・減配トレンドを視覚的に把握できる
- 高成長銘柄と安定銘柄を識別できる
- ポートフォリオの質的評価に活用できる

**実装の考慮点**

- `/trends` などの新しいページとして追加
- 複数銘柄を選択して比較表示できる機能
- 配当成長率（CAGR）の自動計算と表示
- 折れ線グラフでの年別推移表示

**想定工数**: 8-10時間

**優先度**: 高

---

#### 機能0-4: 期間フィルター機能 ★★★

**概要**
表示するデータの期間を自由に絞り込める機能

**メリット**

- 特定の年や月のデータだけを集中して分析できる
- 投資開始から現在までの成長を確認できる
- 市場の変動期など特定イベント前後の比較が容易になる

**実装の考慮点**

- 開始日・終了日の入力フォーム（または年・月のセレクトボックス）
- 全ページ共通のフィルター状態管理（React Context活用）
- フィルター条件の URL パラメータへの反映（ブックマーク可能に）
- 「全期間」に戻すリセットボタン

**想定工数**: 4-6時間

**優先度**: 高

---

### カテゴリ1: データ管理・入力機能

#### 機能1-1: データのエクスポート機能 ★

**概要**
集計結果（年別配当金、累計配当金など）をCSVやJSON形式でエクスポート

**メリット**

- 他のツールでの二次分析が可能
- レポート作成に活用できる
- データのバックアップとして利用可能

**実装の考慮点**

- 各ページにエクスポートボタンを追加
- CSV/JSON/PDFの選択肢
- ファイル名に日付を含める

**想定工数**: 4-6時間

**優先度**: 低

---

### カテゴリ2: 分析・可視化機能

#### 機能2-1: 配当利回り計算機能 ★★

**概要**
投資元本を入力し、配当利回りを自動計算して表示

**メリット**

- ポートフォリオ全体の配当利回りを把握できる
- 目標利回りとの比較ができる
- 投資パフォーマンスの評価に活用できる

**実装の考慮点**

- 投資元本の入力フォーム
- 利回り計算式の実装
- 年別・累計の利回り表示

**想定工数**: 3-4時間

**優先度**: 中

---

#### 機能2-2: 配当再投資シミュレーション ★

**概要**
配当金を再投資した場合のシミュレーション機能

**メリット**

- 複利効果を可視化できる
- 長期投資戦略の評価に活用できる
- 将来の配当収入を予測できる

**実装の考慮点**

- 再投資率の設定（0-100%）
- 想定リターンの設定
- 将来シミュレーションの計算とグラフ表示

**想定工数**: 8-12時間

**優先度**: 低

---

### カテゴリ3: フィルタリング・検索機能

#### 機能3-1: 銘柄検索・フィルター機能 ★★

**概要**
特定の銘柄名やティッカーシンボルで検索・フィルターする機能

**メリット**

- 大量の銘柄データから目的の銘柄を素早く見つけられる
- 複数銘柄を選択して比較分析できる
- 銘柄別レポートの作成が容易になる

**実装の考慮点**

- 検索入力フォーム（オートコンプリート対応）
- 複数選択機能（チェックボックス）
- フィルター結果の保存

**想定工数**: 6-8時間

**優先度**: 中

---

### カテゴリ4: レポート・通知機能

#### 機能4-1: 配当予測機能 ★★

**概要**
過去のデータをもとに、今後の配当金を予測

**メリット**

- 将来の配当収入を見積もれる
- 投資計画の立案に活用できる
- 減配リスクの早期発見に役立つ

**実装の考慮点**

- 単純な線形予測または移動平均
- 信頼区間の表示
- 予測精度の表示

**想定工数**: 8-12時間

**優先度**: 中

---

### カテゴリ5: 設定・カスタマイズ機能

#### 機能5-1: 複数為替レートの保存・管理 ★★

**概要**
よく使う為替レートをプリセットとして保存し、素早く切り替えられる機能

**メリット**

- 複数のシナリオ分析が容易になる
- 為替レートの履歴を保存できる
- ワンクリックで切り替えられる

**実装の考慮点**

- プリセットの保存（localStorage）
- プリセット名の設定
- 削除・編集機能

**想定工数**: 4-6時間

**優先度**: 中

---

#### 機能5-2: チャートカスタマイズ機能 ★

**概要**
チャートの色、フォントサイズ、表示形式などをカスタマイズできる機能

**メリット**

- 視認性を個々の好みに合わせられる
- プレゼンテーション用に調整できる
- 印刷時の見やすさを向上できる

**実装の考慮点**

- カラーピッカーの実装
- 設定の保存（localStorage）
- デフォルト設定へのリセット機能

**想定工数**: 6-8時間

**優先度**: 低

---

#### 機能5-3: データバックアップ・復元機能 ★

**概要**
アプリケーションの設定やアップロードしたCSVデータをバックアップ・復元

**メリット**

- データの損失リスクを軽減できる
- 別のデバイスで同じ設定を使える
- 複数の設定プロファイルを管理できる

**実装の考慮点**

- 設定のJSON形式でのエクスポート
- インポート機能の実装
- バックアップファイルの検証

**想定工数**: 5-7時間

**優先度**: 低

---

### カテゴリ6: 比較・ベンチマーク機能

#### 機能6-1: 市場平均との比較機能 ★★

**概要**
自分の配当ポートフォリオを市場平均（S&P 500の配当利回りなど）と比較

**メリット**

- ポートフォリオのパフォーマンスを客観的に評価できる
- 改善の余地を特定できる
- 投資戦略の見直しに活用できる

**実装の考慮点**

- ベンチマークデータの取得（API連携または手動入力）
- 比較グラフの実装
- 相対パフォーマンスの計算

**想定工数**: 8-10時間

**優先度**: 中

---

#### 機能6-2: 過去の自分との比較機能 ★

**概要**
前年同期や過去の特定時点とのデータ比較機能

**メリット**

- 成長を実感できる
- YoY（前年同期比）の変化を把握できる
- 投資戦略の効果を測定できる

**実装の考慮点**

- 比較基準日の選択
- 差分の計算と表示
- 成長率のビジュアル化

**想定工数**: 5-7時間

**優先度**: 低

---

### カテゴリ7: 教育・サポート機能

#### 機能7-1: ダッシュボードツアー・ヘルプ機能 ★★

**概要**
初回訪問時にアプリの使い方を案内するツアー機能

**メリット**

- 新規ユーザーの学習曲線を短縮できる
- 機能の見落としを防げる
- ユーザーエクスペリエンスの向上

**実装の考慮点**

- react-joyride等のライブラリの使用
- ステップバイステップのガイド
- スキップ・再表示機能

**想定工数**: 6-8時間

**優先度**: 中

---

#### 機能7-2: 配当投資の基礎知識ページ ★

**概要**
配当投資に関する基礎知識や用語解説を提供するページ

**メリット**

- 初心者ユーザーの理解を助ける
- アプリの価値を高める
- SEO効果も期待できる

**実装の考慮点**

- マークダウン形式の記事
- 用語集の実装
- 関連する機能へのリンク

**想定工数**: 8-12時間

**優先度**: 低

---

## 優先度別まとめ

### 高優先度（★★★）

1. **CSVファイルのアップロード機能** - ユーザビリティの大幅向上
2. **月別配当金カレンダービュー** - 新しい視点での可視化
3. **銘柄別トレンド分析** - より深い分析を可能にする
4. **期間フィルター機能** - 柔軟なデータ分析を実現

### 中優先度（★★）

5. **CSVファイルの自動検出・選択機能**
6. **目標設定とプログレスバー**
7. **セクター別配当分析**
8. **配当利回り計算機能**
9. **銘柄検索・フィルター機能**
10. **月次レポート自動生成**
11. **配当予測機能**
12. **複数為替レートの保存・管理**
13. **市場平均との比較機能**
14. **ダッシュボードツアー・ヘルプ機能**

### 低優先度（★）

15. **データのエクスポート機能**
16. **配当再投資シミュレーション**
17. **通貨別フィルター機能**
18. **通知・アラート機能**
19. **チャートカスタマイズ機能**
20. **データバックアップ・復元機能**
21. **過去の自分との比較機能**
22. **配当投資の基礎知識ページ**

---

## 実装ロードマップ案

### フェーズ1: 基盤強化（1-2ヶ月）

- CSVファイルのアップロード機能
- CSVファイルの自動検出・選択機能
- 期間フィルター機能

### フェーズ2: 分析機能の充実（2-3ヶ月）

- 月別配当金カレンダービュー
- 銘柄別トレンド分析
- セクター別配当分析
- 配当利回り計算機能

### フェーズ3: ユーザビリティ向上（1-2ヶ月）

- 目標設定とプログレスバー
- 銘柄検索・フィルター機能
- ダッシュボードツアー・ヘルプ機能
- 複数為替レートの保存・管理

### フェーズ4: 高度な機能追加（2-3ヶ月）

- 月次レポート自動生成
- 配当予測機能
- 市場平均との比較機能
- データのエクスポート機能

### フェーズ5: その他の機能（随時）

- 配当再投資シミュレーション
- 通知・アラート機能
- チャートカスタマイズ機能
- データバックアップ・復元機能
- その他の低優先度機能

---

## 技術的考慮事項

### データ管理

- **ローカルストレージ**: ユーザー設定、プリセット、小規模データ
- **IndexedDB**: 大量のCSVデータ、複数ファイルの管理
- **状態管理**: React Context API（現在）または将来的にZustand/Reduxの導入検討

### パフォーマンス

- 大量データの処理時は Web Worker の使用を検討
- チャートの描画最適化（仮想化、遅延ロード）
- メモ化の活用（useMemo, useCallback）

### セキュリティ

- クライアントサイドでのデータ処理を維持（プライバシー保護）
- XSS対策の徹底
- 外部API使用時のCORS対応

### アクセシビリティ

- ARIA属性の適切な使用
- キーボードナビゲーションの対応
- スクリーンリーダーへの対応

---

## まとめ

このドキュメントでは、divichart-next-js-appに追加可能な22の新機能を7つのカテゴリに分けて提案しました。

**重点的に取り組むべき機能（高優先度）:**

1. CSVファイルのアップロード機能
2. 月別配当金カレンダービュー
3. 銘柄別トレンド分析
4. 期間フィルター機能

これらの機能は、ユーザビリティと分析機能の両面で大きな価値を提供します。

実装の際は、既存コードの品質を維持しつつ、段階的に機能を追加していくことを推奨します。各機能の実装前に、ユーザーフィードバックを収集し、本当に必要な機能に注力することが重要です。

---

## 参考資料

- [doc/improvements.md](./improvements.md) - コード改善提案
- [doc/developer-specification.md](./developer-specification.md) - 開発者向け仕様書
- [README.md](../README.md) - プロジェクト概要

---

## 変更履歴

- 2026年2月9日: 初版作成
